<html xmlns:py="http://genshi.edgewall.org/"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip="">

  <py:def function="page_title">Harvesting Sources</py:def>

  <py:def function="optional_head">
    <link type="text/css" rel="stylesheet" media="all" href="/ckanext/harvest/style.css" />
  </py:def>

<div py:match="content">
  <div class="harvest-content">
  <h1>Harvesting Sources</h1>
    <div id="new-harvest-source"><a href="harvest/new">Add a harvesting source</a></div>
    <py:choose>
        <py:when test="c.sources">


       <table id="harvest-sources">
        <tr>
            <th class="action">View</th>
            <th class="action">Edit</th>
            <th class="action">Refresh</th>
            <th>URL</th>
            <th>Type</th>
            <th>Active</th>
            <th>Statistics</th>
            <th>Next Harvest</th>
            <th>Created</th>
        </tr>

        <tr py:for="source in c.sources">
            <td><a href="harvest/${source.id}"><img src="ckanext/harvest/images/icons/source_view.png" alt="View" title="View" /></a></td>
            <td><a href="harvest/edit/${source.id}"><img src="ckanext/harvest/images/icons/source_edit.png" alt="Edit" title="Edit" /></a></td>
            <td><a href="harvest/refresh/${source.id}"><img src="ckanext/harvest/images/icons/source_refresh.png" alt="Refresh" title="Refresh" /></a></td>
            <td>${source.url}</td>
            <td>${source.type}</td>
            <td>${source.active}</td>
            <py:choose>
                <py:when test="'msg' in source.status">
                    <td>${source.status.msg}</td>
                    <td>${source.status.msg}</td>
                </py:when>
                <py:otherwise>
                    <td>${source.status.overall_statistics.added} pkgs ${source.status.overall_statistics.errors} errors</td>
                    <td>${source.status.next_harvest}</td>
                </py:otherwise>
            </py:choose>

            <td>${source.created}</td>
         </tr>
    </table>
   </py:when>
    <py:otherwise>
        <div id="no-harvest-sources">No harvest sources defined yet.</div>
    </py:otherwise>
  </py:choose>
 
  </div>
</div>
<xi:include href="layout.html" />
</html>
